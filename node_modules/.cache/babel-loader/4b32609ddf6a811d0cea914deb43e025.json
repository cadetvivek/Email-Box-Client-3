{"ast":null,"code":"import _toConsumableArray from\"D:/React/React-Nots-E/Email-box-3/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"D:/React/React-Nots-E/Email-box-3/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/React/React-Nots-E/Email-box-3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Fragment,useEffect,useState}from\"react\";import{NavLink}from\"react-router-dom\";import{useSelector,useDispatch}from\"react-redux\";import styles from\"./Home.module.css\";import{getUsername}from\"../../helper\";import{mailActions}from\"../../store/mailSlice\";import Mail from\"./Mail\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Inbox=function Inbox(){var dispatch=useDispatch();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),inboxMail=_useState2[0],setInboxMail=_useState2[1];var user=localStorage.getItem(\"email\");var username=getUsername(user);useEffect(function(){var timer=setInterval(function(){var mails=[];fetch(\"https://mail-box-49aa1-default-rtdb.firebaseio.com/\".concat(username,\"/receiver.json\")).then(function(res){return res.json();}).then(function(data){var notOpened=0;for(var _i=0,_Object$entries=Object.entries(data);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];mails.push(_objectSpread({key:key},value));if(value.isOpen===false){notOpened+=1;}}setInboxMail(mails);dispatch(mailActions.countNotOpened(notOpened));});},2000);return function(){return clearInterval(timer);};},[dispatch]);var deleteHandler=function deleteHandler(key){fetch(\"https://mail-box-49aa1-default-rtdb.firebaseio.com/\".concat(username,\"/receiver/\").concat(key,\".json\"),{method:\"DELETE\"}).then(function(res){var inboxMailCopy=_toConsumableArray(inboxMail);var index=inboxMailCopy.findIndex(function(item){return item.key===key;});inboxMailCopy.splice(index,1);setInboxMail(inboxMailCopy);});};var notOpened=useSelector(function(state){return state.mail.totalNotOpened;});return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.sidebar,children:[/*#__PURE__*/_jsxs(NavLink,{to:\"/home\",className:styles.none,activeClassName:styles.active,children:[\" \",/*#__PURE__*/_jsx(\"div\",{children:\"Compose\"})]}),/*#__PURE__*/_jsx(NavLink,{to:\"/inbox\",className:styles.none,activeClassName:styles.active,children:/*#__PURE__*/_jsxs(\"div\",{children:[\"Inbox \",/*#__PURE__*/_jsxs(\"span\",{className:styles.unread,children:[\"Unread (\",notOpened,\")\"]})]})}),/*#__PURE__*/_jsxs(NavLink,{to:\"/sent\",className:styles.none,activeClassName:styles.active,children:[\" \",/*#__PURE__*/_jsx(\"div\",{children:\"Sent\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.mailsContainer,children:inboxMail.map(function(mail){return/*#__PURE__*/_jsx(Mail,{mail:mail,deleteItem:deleteHandler,isSentBox:false},mail.key);})})]})});};export default Inbox;","map":{"version":3,"names":["React","Fragment","useEffect","useState","NavLink","useSelector","useDispatch","styles","getUsername","mailActions","Mail","Inbox","dispatch","inboxMail","setInboxMail","user","localStorage","getItem","username","timer","setInterval","mails","fetch","then","res","json","data","notOpened","Object","entries","key","value","push","isOpen","countNotOpened","clearInterval","deleteHandler","method","inboxMailCopy","index","findIndex","item","splice","state","mail","totalNotOpened","container","sidebar","none","active","unread","mailsContainer","map"],"sources":["D:/React/React-Nots-E/Email-box-3/src/components/pages/Inbox.js"],"sourcesContent":["import React, { Fragment, useEffect, useState } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport styles from \"./Home.module.css\";\nimport { getUsername } from \"../../helper\";\nimport { mailActions } from \"../../store/mailSlice\";\nimport Mail from \"./Mail\";\n\nconst Inbox = () => {\n  const dispatch = useDispatch();\n  const [inboxMail, setInboxMail] = useState([]);\n  const user = localStorage.getItem(\"email\");\n  const username = getUsername(user);\n  useEffect(() => {\n    const timer = setInterval(() => {\n      let mails = [];  \n    \n    fetch(\n      `https://mail-box-49aa1-default-rtdb.firebaseio.com/${username}/receiver.json`\n    )\n      .then((res) => {\n        return res.json();\n      })\n      .then((data) => {\n        let notOpened = 0;\n        for (let [key, value] of Object.entries(data)) {\n          mails.push({ key, ...value });\n          if (value.isOpen === false) {\n            notOpened += 1;\n          }\n        }\n        setInboxMail(mails);\n        dispatch(mailActions.countNotOpened(notOpened));\n      })\n  \n    }, 2000);\n    return () => clearInterval(timer);\n  }, [dispatch]);\n\n  const deleteHandler = (key) => {\n     fetch(`https://mail-box-49aa1-default-rtdb.firebaseio.com/${username}/receiver/${key}.json`, {\n        method: \"DELETE\",\n    }).then((res) => {\n      const inboxMailCopy = [...inboxMail]\n        const index = inboxMailCopy.findIndex((item) => item.key === key);\n        inboxMailCopy.splice(index, 1)\n        setInboxMail(inboxMailCopy);\n    })\n  }\n\n  const notOpened = useSelector((state) => state.mail.totalNotOpened);\n\n  return (\n    <Fragment>\n      <div className={styles.container}>\n        <div className={styles.sidebar}>\n          <NavLink\n            to=\"/home\"\n            className={styles.none}\n            activeClassName={styles.active}\n          >\n            {\" \"}\n            <div>Compose</div>\n          </NavLink>\n          <NavLink\n            to=\"/inbox\"\n            className={styles.none}\n            activeClassName={styles.active}\n          >\n            <div>\n              Inbox <span className={styles.unread}>Unread ({notOpened})</span>\n            </div>\n          </NavLink>\n          <NavLink\n            to=\"/sent\"\n            className={styles.none}\n            activeClassName={styles.active}\n          >\n            {\" \"}\n            <div>Sent</div>\n          </NavLink>\n        </div>\n\n        <div className={styles.mailsContainer}>\n          {inboxMail.map((mail) => {\n            return <Mail key={mail.key} mail={mail} deleteItem={deleteHandler} isSentBox={false} />;\n          })}\n        </div>\n      </div>\n    </Fragment>\n  );\n};\nexport default Inbox;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}